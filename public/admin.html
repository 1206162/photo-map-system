<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>管理者画面</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    .photo-list { display: flex; flex-wrap: wrap; gap: 20px; }
    .photo-card { border: 1px solid #ccc; padding: 10px; width: 220px; }
    .photo-card img { max-width: 200px; max-height: 200px; }
  </style>
</head>
<body>
  <h2>写真管理</h2>
  <div class="photo-list" id="photoList"></div>
  <script>
    const rooms = ['402', '403', '404', '405'];
    async function loadPhotos() {
      const res = await fetch('/admin/photos');
      const photos = await res.json();
      const container = document.getElementById('photoList');
      container.innerHTML = '';
      photos.forEach(photo => {
        const card = document.createElement('div');
        card.className = 'photo-card';
        card.innerHTML = `
          <img src="${photo.url}" alt="photo">
          <p>${photo.comment || ''}</p>
          <select>${rooms.map(r => `<option value="${r}" ${r === photo.room ? 'selected' : ''}>${r}</option>`).join('')}</select>
          <label><input type="checkbox" ${photo.approved ? 'checked' : ''}> 承認</label>
          <button>保存</button>
        `;
        const button = card.querySelector('button');
        button.onclick = async () => {
          const approved = card.querySelector('input').checked;
          const room = card.querySelector('select').value;
          await fetch('/admin/assign', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ id: photo.id, room, approved })
          });
          alert('保存しました');
        };
        container.appendChild(card);
      });
    }
    loadPhotos();
  </script>
</body>
</html>
          const room = document.getElementById(`room-${photo.room}`);
          if (room) {
            room.classList.add('highlight');
          }
          const modal = document.getElementById('modal');
          const modalImg = document.getElementById('modal-img');
          modalImg.src = photo.url;
          modal.style.display = 'flex';
        });

        svg.appendChild(img);
      });
    }

    document.getElementById('modal').addEventListener('click', () => {
      document.getElementById('modal').style.display = 'none';
    });

    loadPhotos();
  </script>